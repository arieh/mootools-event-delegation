(function(){var h=function(a,c,b){for(var d in a)a.hasOwnProperty(d)&&c.apply(b||this,[d,a[d]]);return a};Element.implement({toSelector:function(){var a=[],c=this.get("id"),b=this.get("name"),d=this.get("class");c&&a.push("#",c);b&&a.push("[name=",b,"]");d&&a.push(".",d.replace(" ","."));return a.join("")},delegateEvent:function(a,c){var b=this,d="delegates:"+a,e=this.retrieve(d)||!1,f=function(a){var c=document.id(a.target),e=e||!0,f=f||!1,g=b.retrieve(d),i=arguments;h(g,function(d,g){if(d=="self"&&(c==b||c.getParents().contains(b))||c.match(d))d!="self"&&(e&&a.preventDefault(),f||a.stopPropagation()),h(g,function(a,b){b.apply(c,i)})},b);return b};if(e)return h(c,function(a,b){e[a]?e[a].push(b):e[a]=[b]}),b;else e={},h(c,function(a,b){e[a]=[b]}),b.store(d,e);if(/focus|blur|change/.test(a)){var g=function(a){a=new Event(a,b.getWindow());f.call(b,a)};if(Browser.ie)switch(a){case "focus":b.attachEvent("onfocusin",g);break;case "blur":b.attachEvent("onfocusout",g);break;case "change":b.attachEvent("change",g)}else b.addEventListener(a,g,!0)}else b.addEvent(a,f);return b},delegateEvents:function(a,c,b){h(a,function(a,e){this.delegateEvent(a,e,c,b)},this);return this},denyEvent:function(a,c,b){(a=this.retrieve("delegates:"+a)||!1)&&a[c]&&a[c].erase(b);return this},denyEvents:function(a,c){var b=this.retrieve("delegates:"+a)||!1;b&&b[c]&&delete b[c];return this},hoistEvent:function(a,c,b,d,e){var f={};f[this.toSelector()]=b;return a.delegateEvent.apply(a,[c,f,d,e])},hoistEvents:function(a,c,b,d){var e={},f=this.toSelector();h(c,function(a,b){e[a]={};e[a][f]=b},this);return a.delegateEvents.apply(a,[e,b,d])},dropEvent:function(a,c,b){return a.denyEvent(this.toSelector(),c,b)},dropEvents:function(a,c){return a.denyEvents(c,this.toSelector())}})})();